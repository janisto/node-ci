language: node_js
dist: trusty
sudo: true
node_js:
  - "6"
before_install:
  - export CLOUD_SDK_REPO="cloud-sdk-$(lsb_release -c -s)"
  - echo "deb https://packages.cloud.google.com/apt $CLOUD_SDK_REPO main" | sudo tee -a /etc/apt/sources.list.d/google-cloud-sdk.list
  - curl https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key add -
  - sudo apt-get update && sudo apt-get install google-cloud-sdk google-cloud-sdk-datastore-emulator google-cloud-sdk-pubsub-emulator
cache:
  directories:
    - "node_modules"
env:
  - DIR=./
  - DIR=modules/fi.xxx.sample
  - DIR=modules/fi.xxx.test
  - DIR=modules/fi.xxx.datastore
matrix:
  fast_finish: true
script: cd $DIR && npm install && npm test